<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Documentation for Mycodo" name="description"/><link href="../assets/images/favicon.png" rel="shortcut icon"/><meta content="mkdocs-1.1.2, mkdocs-material-5.5.0" name="generator"/><title>Device Notes - Mycodo</title><link href="../assets/stylesheets/main.b5d04df8.min.css" rel="stylesheet"/><link href="../assets/stylesheets/palette.9ab2c1f8.min.css" rel="stylesheet"/><meta content="#2196f3" name="theme-color"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Barlow:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/><style>body,input{font-family:"Barlow",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style></head> <body data-md-color-accent="indigo" data-md-color-primary="blue" data-md-color-scheme="preference" dir="ltr"> <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#edge-detection"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header" data-md-component="header"> <nav aria-label="Header" class="md-header-nav md-grid"> <a aria-label="Mycodo" class="md-header-nav__button md-logo" href=".." title="Mycodo"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg> </a> <label class="md-header-nav__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg> </label> <div class="md-header-nav__title" data-md-component="header-title"> <div class="md-header-nav__ellipsis"> <span class="md-header-nav__topic md-ellipsis"> Mycodo </span> <span class="md-header-nav__topic md-ellipsis"> Device Notes </span> </div> </div> <label class="md-header-nav__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg> </label> <button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg> </button> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> <div class="md-header-nav__source"> <a class="md-source" href="https://github.com/kizniche/Mycodo/" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg> </div> <div class="md-source__repository"> kizniche/Mycodo </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <nav aria-label="Tabs" class="md-tabs md-tabs--active" data-md-component="tabs"> <div class="md-tabs__inner md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link" href=".."> Home </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../Data-Viewing/"> Usage </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link md-tabs__link--active" href="../Dependencies/"> Devices </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../System-Information/"> System </a> </li> </ul> </div> </nav> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="Mycodo" class="md-nav__button md-logo" href=".." title="Mycodo"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg> </a> Mycodo </label> <div class="md-nav__source"> <a class="md-source" href="https://github.com/kizniche/Mycodo/" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg> </div> <div class="md-source__repository"> kizniche/Mycodo </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href=".." title="Home"> Home </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../About/" title="About"> About </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Frequently-Asked-Questions/" title="Frequently Asked Questions"> Frequently Asked Questions </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/> <label class="md-nav__link" for="nav-4"> Usage <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg> </span> </label> <nav aria-label="Usage" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="nav-4"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg> </span> Usage </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../Data-Viewing/" title="Data Viewing"> Data Viewing </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Inputs/" title="Inputs"> Inputs </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Outputs/" title="Outputs"> Outputs </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Functions/" title="Functions"> Functions </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Methods/" title="Methods"> Methods </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../LCDs/" title="LCDs"> LCDs </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Alerts/" title="Alerts"> Alerts </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Notes/" title="Notes"> Notes </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Camera/" title="Camera"> Camera </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Energy-Usage/" title="Energy Usage"> Energy Usage </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Translations/" title="Translations"> Translations </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Troubleshooting/" title="Troubleshooting"> Troubleshooting </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-7" id="nav-7" type="checkbox"/> <label class="md-nav__link" for="nav-7"> Devices <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg> </span> </label> <nav aria-label="Devices" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="nav-7"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg> </span> Devices </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../Dependencies/" title="Dependencies"> Dependencies </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Input-Devices/" title="Input Devices"> Input Devices </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Output-Devices/" title="Output Devices"> Output Devices </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../I2C-Multiplexers/" title="I2C Multiplexers"> I2C Multiplexers </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Analog-To-Digital-Converters/" title="Analog-To-Digital Converters"> Analog-To-Digital Converters </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Interfaces/" title="Interfaces"> Interfaces </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> Device Notes <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path></svg> </span> </label> <a class="md-nav__link md-nav__link--active" href="./" title="Device Notes"> Device Notes </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg> </span> Table of contents </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#edge-detection"> Edge Detection </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#lcd-displays"> LCD Displays </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#raspberry-pi"> Raspberry Pi </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#am2315"> AM2315 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#k-30"> K-30 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#usb-device-persistence-across-reboots"> USB Device Persistence Across Reboots </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#diagrams"> Diagrams </a> <nav aria-label="Diagrams" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#dht11-diagrams"> DHT11 Diagrams </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#ds18b20-diagrams"> DS18B20 Diagrams </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#raspberry-pi-and-relay-diagrams"> Raspberry Pi and Relay Diagrams </a> <nav aria-label="Raspberry Pi and Relay Diagrams" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#raspberry-pi-4-relays-4-outlets-1-ds18b20-sensor"> Raspberry Pi, 4 relays, 4 outlets, 1 DS18B20 sensor </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#raspberry-pi-8-relays-8-outlets"> Raspberry Pi, 8 relays, 8 outlets </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" id="nav-8" type="checkbox"/> <label class="md-nav__link" for="nav-8"> System <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg> </span> </label> <nav aria-label="System" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="nav-8"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg> </span> System </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../System-Information/" title="System Information"> System Information </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Configuration-Settings/" title="System Configuration"> System Configuration </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Upgrade-Backup-Restore/" title="Upgrade/Backup/Restore"> Upgrade/Backup/Restore </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Export-Import/" title="Export/Import"> Export/Import </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../Mycodo-Client/" title="Mycodo Client"> Mycodo Client </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg> </span> Table of contents </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#edge-detection"> Edge Detection </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#lcd-displays"> LCD Displays </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#raspberry-pi"> Raspberry Pi </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#am2315"> AM2315 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#k-30"> K-30 </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#usb-device-persistence-across-reboots"> USB Device Persistence Across Reboots </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#diagrams"> Diagrams </a> <nav aria-label="Diagrams" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#dht11-diagrams"> DHT11 Diagrams </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#ds18b20-diagrams"> DS18B20 Diagrams </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#raspberry-pi-and-relay-diagrams"> Raspberry Pi and Relay Diagrams </a> <nav aria-label="Raspberry Pi and Relay Diagrams" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#raspberry-pi-4-relays-4-outlets-1-ds18b20-sensor"> Raspberry Pi, 4 relays, 4 outlets, 1 DS18B20 sensor </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#raspberry-pi-8-relays-8-outlets"> Raspberry Pi, 8 relays, 8 outlets </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content"> <article class="md-content__inner md-typeset"><a class="md-content__icon pdf-download-btn" download href="../pdf/manual-mkdocs.pdf" title="Download"><i class="fa fas fa-download"></i><small> PDF</small></a> <a class="md-content__button md-icon" href="https://github.com/kizniche/Mycodo/edit/master/docs/Device-Notes.md" title="Edit this page"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg> </a> <h1>Device Notes</h1> <p>This information may not be current, so always reference and follow manufacturer recommendations for operating their devices.</p> <h2 id="edge-detection">Edge Detection<a class="headerlink" href="#edge-detection" title="Permanent link">~</a></h2> <p>The detection of a changing signal, for instance a simple switch completing a circuit, requires the use of edge detection. By detecting a rising edge (LOW to HIGH), a falling edge (HIGH to LOW), or both, actions or events can be triggered. The GPIO chosen to detect the signal should be equipped with an appropriate resistor that either pulls the GPIO up [to 5-volts] or down [to ground]. The option to enable the internal pull-up or pull-down resistors is not available for safety reasons. Use your own resistor to pull the GPIO high or low.</p> <p>Examples of devices that can be used with edge detection: simple switches and buttons, PIR motion sensors, reed switches, hall effect sensors, float switches, and more.</p> <h2 id="lcd-displays">LCD Displays<a class="headerlink" href="#lcd-displays" title="Permanent link">~</a></h2> <p>There are only a few number fo LCDs that are supported. 16x2 and 20x4 character LCD displays with I2C backpacks and the <a href="https://www.adafruit.com/product/931">128x32</a> / <a href="https://www.adafruit.com/product/931">128x64</a> OLED displays are supported. The below image is the type of device with the I2C backpack that should be compatible.</p> <p><img alt="image4" src="../manual_images/LCD-front-back.jpg"/> </p> <h2 id="raspberry-pi">Raspberry Pi<a class="headerlink" href="#raspberry-pi" title="Permanent link">~</a></h2> <p>The Raspberry Pi has an integrated temperature sensor on the BCM2835 SoC that measure the temperature of the CPU/GPU. This is the easiest sensor to set up in Mycodo, as it is immediately available to be used.</p> <h2 id="am2315">AM2315<a class="headerlink" href="#am2315" title="Permanent link">~</a></h2> <p>From <a href="https://github.com/kizniche/Mycodo/issues/315#issuecomment-344798815">@Theoi-Meteoroi</a> on GitHub:</p> <p>I figured out why this [AM2315] sensor is unreliable with Rpi3 hardware I2C. It is among a number of I2C devices that really hates the BCM2835 clock stretching blunder (hardware bug: <a href="https://github.com/raspberrypi/linux/issues/254">raspberrypi/linux#254</a>). The wakeup attempts fail, consistently. I checked the bitstream with a sniffer, and see that the sensor may respond once out of 20 or so tries (or not at all) but only with a single byte returned. The solution is to use a software implementation of the I2C bus. You need to add pull-up resistors (4.7k is dandy) to 3.3v and install the i2c_gpio device overlay. Seems to work fine now, will run for a few days, but the CRC failures are gone and I get good readings, every time. And no twiddling the power for the sensor is required.</p> <p>To enable software I2C, add the following line to your <code>/boot/config.txt</code></p> <p><code>dtoverlay=i2c-gpio,i2c_gpio_sda=23,i2c_gpio_scl=24,i2c_gpio_delay_us=4</code></p> <p>After rebooting, a new I2C bus at /dev/i2c-3 should exist with SDA on pin 23 (BCM) and SCL on pin 24 (BCM). Make sure you add the appropriate pull-up resistors before connecting any devices.</p> <h2 id="k-30">K-30<a class="headerlink" href="#k-30" title="Permanent link">~</a></h2> <p><img alt="image5" src="../manual_images/Sensor-K30-01.jpg"/> </p> <p>Be very careful when connecting the K-30, as there is no reverse-voltage protection and improper connections could destroy your sensor.</p> <p>Wiring instructions for the Raspberry Pi can be found <a href="https://www.co2meter.com/blogs/news/8307094-using-co2meter-com-sensors-with-raspberry-pi">here</a>.</p> <h2 id="usb-device-persistence-across-reboots">USB Device Persistence Across Reboots<a class="headerlink" href="#usb-device-persistence-across-reboots" title="Permanent link">~</a></h2> <p>From <a href="https://github.com/kizniche/Mycodo/issues/547#issuecomment-428752904">(#547) Theoi-Meteoroi on Github</a>:</p> <p>Using USB devices, such as USB-to-serial interfaces (CP210x) to connect a sensor, while convenient, poses an issue if there are multiple devices when the system reboots. After a reboot, there is no guarantee the device will persist with the same name. For instance, if Sensor A is /dev/ttyUSB0 and Sensor B is /dev/ttyUSB1, after a reboot Sensor A may be /dev/ttyUSB1 and Sensor B may be /dev/ttyUSB0. This will cause Mycodo to query the wrong device for a measurement, potentially causing a mis-measurement, or worse, an incorrect measurement because the response is not from the correct sensor (I've seen my temperature sensor read 700+ degrees celsius because of this!). Follow the instructions below to alleviate this issue.</p> <p>I use udev to create a persistent device name ('/dev/dust-sensor') that will be linked to the /dev/ttyUSBn that is chosen at device arrival in the kernel. The only requirement is some attribute returned from the USB device that is unique. The common circumstance is that none of the attributes are unique and you get stuck with just VID and PID, which is ok as long as you don't have any other adapters that report the same VID and PID. If you have multiple adapters with the same VID and PID, then hopefully they have some unique attribute. This command will walk the attributes. Run on each USB device and then compare differences to possibly find some attribute to use.</p> <p><code>udevadm info --name=/dev/ttyUSB0 --attribute-walk</code></p> <p>I ended up using the serial number on the ZH03B to program the USB adapter serial field. This way guarantees unique serial numbers rather than me trying to remember what was the last serial number I used to increment by 1.</p> <p>When you plug a USB device in it can be enumerated to different device names by the operating system. To fix this problem for this sensor on linux, I changed attributes that make the connection unique.</p> <p>First - find the VID and PID for the USB device:</p> <div class="codehilite"><pre><span></span><code><span class="err">pi@raspberry:~ $ lsusb</span>
<span class="err">Bus 001 Device 008: ID 10c4:ea60 Cygnal Integrated Products, Inc. CP210x UART Bridge / myAVR mySmartUSB light</span>
<span class="err">Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. SMSC9512/9514 Fast Ethernet Adapter</span>
<span class="err">Bus 001 Device 002: ID 0424:9514 Standard Microsystems Corp. SMC9514 Hub</span>
<span class="err">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span>
</code></pre></div> <p>In this case the Vendor ID is 10c4 The Product ID is ea60</p> <p>Note: If you have multiple devices and you find your IDs to be the same, you can change IDs with the Simplicity Studio Xpress Configurator tool (discussed starting on page 6 of the <a href="https://www.silabs.com/documents/public/application-notes/AN721.pdf">AN721: USBXpress™ Device Configuration and Programming Guide</a>).</p> <p>Since I changed the serial number field - this will be unique.</p> <div class="codehilite"><pre><span></span><code><span class="err">pi@raspberry:~ $ udevadm info --name=/dev/ttyUSB0 --attribute-walk | grep serial</span>
<span class="err">SUBSYSTEMS=="usb-serial"</span>
<span class="err">ATTRS{serial}=="ZH03B180904"</span>
<span class="err">ATTRS{serial}=="3f980000.usb"</span>
</code></pre></div> <p>Now I have an attribute to tell udev what to do. I create a file in /etc/udev/rules.d with a name like "99-dustsensor.rules". In that file I tell udev what device name to create when it sees this device plugged in:</p> <p><code>SUBSYSTEM=="tty", ATTRS{idVendor}=="10c4", ATTRS{idProduct}=="ea60", ATTRS{serial}=="ZH03B180904" SYMLINK+="dust-sensor"</code></p> <p>To test the new rule:</p> <div class="codehilite"><pre><span></span><code><span class="err">pi@raspberry:/dev $ sudo udevadm trigger</span>
<span class="err">pi@raspberry:/dev $ ls -al dust-sensor</span>
<span class="err">lrwxrwxrwx 1 root root 7 Oct 6 21:04 dust-sensor -&gt; ttyUSB0</span>
</code></pre></div> <p>Now, every time the dust sensor is plugged in, it shows up at /dev/dust-sensor</p> <h2 id="diagrams">Diagrams<a class="headerlink" href="#diagrams" title="Permanent link">~</a></h2> <h3 id="dht11-diagrams">DHT11 Diagrams<a class="headerlink" href="#dht11-diagrams" title="Permanent link">~</a></h3> <p><img alt="Schematic-Sensor-DHT11-01" src="../manual_images/Schematic-Sensor-DHT11-01.jpg"/> </p> <p><img alt="Schematic-Sensor-DHT11-02" src="../manual_images/Schematic-Sensor-DHT11-02.png"/> </p> <h3 id="ds18b20-diagrams">DS18B20 Diagrams<a class="headerlink" href="#ds18b20-diagrams" title="Permanent link">~</a></h3> <p><img alt="Schematic-Sensor-DS18B20-01" src="../manual_images/Schematic-Sensor-DS18B20-01.png"/> </p> <p><img alt="Schematic-Sensor-DS18B20-02" src="../manual_images/Schematic-Sensor-DS18B20-02.jpg"/> </p> <p><img alt="Schematic-Sensor-DS18B20-03" src="../manual_images/Schematic-Sensor-DS18B20-03.jpg"/> </p> <h3 id="raspberry-pi-and-relay-diagrams">Raspberry Pi and Relay Diagrams<a class="headerlink" href="#raspberry-pi-and-relay-diagrams" title="Permanent link">~</a></h3> <h4 id="raspberry-pi-4-relays-4-outlets-1-ds18b20-sensor">Raspberry Pi, 4 relays, 4 outlets, 1 DS18B20 sensor<a class="headerlink" href="#raspberry-pi-4-relays-4-outlets-1-ds18b20-sensor" title="Permanent link">~</a></h4> <p><img alt="Schematic: Pi, 4 relays, 4 outlets, and 1 DS18B20 sensor" src="../manual_images/Schematic-Pi-4-relays.png"/> </p> <h4 id="raspberry-pi-8-relays-8-outlets">Raspberry Pi, 8 relays, 8 outlets<a class="headerlink" href="#raspberry-pi-8-relays-8-outlets" title="Permanent link">~</a></h4> <p><img alt="Schematic: Pi, 8 relays, and 8 outlets" src="../manual_images/Schematic-Pi-8-relays.png"/> </p> </article> </div> </div> </main> <footer class="md-footer"> <div class="md-footer-nav"> <nav aria-label="Footer" class="md-footer-nav__inner md-grid"> <a class="md-footer-nav__link md-footer-nav__link--prev" href="../Interfaces/" rel="prev" title="Interfaces"> <div class="md-footer-nav__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg> </div> <div class="md-footer-nav__title"> <div class="md-ellipsis"> <span class="md-footer-nav__direction"> Previous </span> Interfaces </div> </div> </a> <a class="md-footer-nav__link md-footer-nav__link--next" href="../System-Information/" rel="next" title="System Information"> <div class="md-footer-nav__title"> <div class="md-ellipsis"> <span class="md-footer-nav__direction"> Next </span> System Information </div> </div> <div class="md-footer-nav__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-footer-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src="../assets/javascripts/vendor.92ffa368.min.js"></script> <script src="../assets/javascripts/bundle.5123e3d4.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "..",
          features: ["tabs"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>